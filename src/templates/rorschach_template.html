<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workspace Rorschach - Alex Yalın</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/jpeg" href="assets/avatar.jpg">
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; background-color: #f4f1ea; color: #111; }
        canvas { display: block; }
        .overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
            z-index: 10;
        }
        .overlay h1 {
            font-family: 'Inter', sans-serif;
            font-size: 1.2rem;
            color: #111;
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        .overlay p {
            font-family: 'Lora', serif;
            font-size: 0.8rem;
            color: #555;
            margin: 5px 0 0 0;
        }
        .back-link {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            color: #555;
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.3s;
            pointer-events: auto;
        }
        .back-link:hover {
            color: #000;
            border-bottom-color: #000;
        }
    </style>
</head>
<body>
    <div class="overlay">
        <h1>Workspace Rorschach</h1>
        <p>Your digital footprint. Data as ink.</p>
    </div>
    
    <a href="gallery.html" class="back-link">&larr; Back to Gallery</a>

    <canvas id="rorschachCanvas"></canvas>

    <script>
        const canvas = document.getElementById('rorschachCanvas');
        const ctx = canvas.getContext('2d');
        let width, height;
        
        // Bu değişken build.js tarafından gerçek veriyle değiştirilecek
        const INJECTED_DATA = []; 

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            draw();
        }

        function getColor(type) {
            switch(type) {
                case 'html': return 'rgba(231, 76, 60, 0.5)'; // Kırmızı
                case 'js': return 'rgba(241, 196, 15, 0.5)'; // Sarı
                case 'css': return 'rgba(52, 152, 219, 0.5)'; // Mavi
                case 'json': return 'rgba(46, 204, 113, 0.5)'; // Yeşil
                case 'md': return 'rgba(149, 165, 166, 0.5)'; // Gri
                default: return 'rgba(52, 73, 94, 0.5)'; // Koyu
            }
        }

        function draw() {
            ctx.clearRect(0, 0, width, height); // Temizle
            ctx.fillStyle = '#f4f1ea'; 
            ctx.fillRect(0, 0, width, height);
            
            // Simetri ekseni (Dikey)
            const cx = width / 2;
            const cy = height / 2;

            // Karıştırma modu (Mürekkep etkisi)
            ctx.globalCompositeOperation = 'multiply';

            INJECTED_DATA.forEach((file, i) => {
                // Veriyi görselleştirmeye çevir
                // Boyut -> Yarıçap (Logaritmik, çok büyük dosyalar ekranı kaplamasın)
                const r = Math.min(Math.log(file.size + 1) * 8, 150); 
                
                // Konum -> Spiral (Phyllotaxis) + Rastgelelik (Dosya isminden hash)
                // Dosya isminden basit bir hash üretelim ki sabit kalsın
                let hash = 0;
                for (let j = 0; j < file.name.length; j++) hash = file.name.charCodeAt(j) + ((hash << 5) - hash);
                
                // Spiral koordinatları
                const angle = i * 0.5 + (hash % 10); 
                const dist = Math.sqrt(i) * 30 + (Math.abs(hash) % 100);
                
                const x = cx + Math.cos(angle) * dist;
                const y = cy + Math.sin(angle) * dist;
                
                const color = getColor(file.type);
                
                // Sol tarafı çiz
                drawBlob(x, y, r, color);
                
                // Sağ tarafı çiz (Ayna - X eksenine göre simetri)
                // Ayna noktası: Merkezden (x-cx) kadar sağa değil, sola gitmeli
                const xMirror = cx - (x - cx);
                drawBlob(xMirror, y, r, color);
            });
            
            ctx.globalCompositeOperation = 'source-over';
        }

        function drawBlob(x, y, r, color) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.arc(x, y, r, 0, Math.PI * 2);
            ctx.fill();
        }

        window.addEventListener('resize', init);
        
        // Başlat
        if (INJECTED_DATA.length > 0) {
            init();
        } else {
            console.log("No data injected.");
        }
    </script>
</body>
</html>