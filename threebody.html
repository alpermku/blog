<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three-Body Problem - Alex Yalın</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/jpeg" href="assets/avatar.jpg">
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; background-color: #050505; color: #eee; }
        canvas { display: block; }
        .overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
            z-index: 10;
        }
        .overlay h1 {
            font-family: 'Inter', sans-serif;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(255,255,255,0.3);
        }
        .overlay p {
            font-family: 'Lora', serif;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            margin: 5px 0 0 0;
        }
        .back-link {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.4);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.3s;
            pointer-events: auto;
        }
        .back-link:hover {
            color: #fff;
            border-bottom-color: #fff;
        }
    </style>
</head>
<body>
    <div class="overlay">
        <h1>Three-Body Problem</h1>
        <p>Gravitational chaos. Three suns, no solution.</p>
    </div>
    
    <a href="gallery.html" class="back-link">&larr; Back to Gallery</a>

    <canvas id="threeBodyCanvas"></canvas>

    <script>
        const canvas = document.getElementById('threeBodyCanvas');
        const ctx = canvas.getContext('2d');

        let width, height;
        const G = 1.0; // Gravity constant
        
        class Body {
            constructor(x, y, vx, vy, mass, color) {
                this.x = x;
                this.y = y;
                this.vx = vx;
                this.vy = vy;
                this.mass = mass;
                this.color = color;
                this.path = [];
                this.maxPath = 1000;
            }

            update(bodies) {
                let fx = 0;
                let fy = 0;

                for (let other of bodies) {
                    if (other === this) continue;

                    const dx = other.x - this.x;
                    const dy = other.y - this.y;
                    const distSq = dx*dx + dy*dy;
                    const dist = Math.sqrt(distSq);
                    
                    // Softening to prevent infinite force
                    const force = (G * this.mass * other.mass) / (distSq + 500); 
                    
                    fx += force * (dx / dist);
                    fy += force * (dy / dist);
                }

                this.vx += fx / this.mass;
                this.vy += fy / this.mass;

                this.x += this.vx;
                this.y += this.vy;

                // Path recording
                if (this.path.length === 0 || 
                    Math.hypot(this.x - this.path[this.path.length-1].x, this.y - this.path[this.path.length-1].y) > 2) {
                    this.path.push({x: this.x, y: this.y});
                }
                
                if (this.path.length > this.maxPath) {
                    this.path.shift();
                }
            }

            draw() {
                // Glow
                ctx.shadowBlur = 15;
                ctx.shadowColor = this.color;

                // Path
                ctx.beginPath();
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 2;
                ctx.globalAlpha = 0.6;
                
                if (this.path.length > 1) {
                    ctx.moveTo(this.path[0].x, this.path[0].y);
                    for (let i = 1; i < this.path.length; i++) {
                        ctx.lineTo(this.path[i].x, this.path[i].y);
                    }
                    ctx.stroke();
                }
                
                ctx.globalAlpha = 1.0;

                // Body
                ctx.beginPath();
                const radius = Math.sqrt(this.mass); 
                ctx.arc(this.x, this.y, radius, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
                
                ctx.shadowBlur = 0;
            }
        }

        let bodies = [];

        function randomRange(min, max) {
            return Math.random() * (max - min) + min;
        }

        function init() {
            width = canvas.width = window.innerWidth;
            height = canvas.height = window.innerHeight;
            
            // Random Initialization
            // But kept within a reasonable range to ensure interaction
            
            const area = Math.min(width, height) * 0.3; // Ekrana göre ölçekle
            
            bodies = [
                // Yellow Sun (Heavy)
                new Body(
                    randomRange(-area, area), 
                    randomRange(-area, area), 
                    randomRange(-1, 1), 
                    randomRange(-1, 1), 
                    randomRange(300, 500), 
                    '#ffcc00'
                ),
                // Red Dwarf (Medium)
                new Body(
                    randomRange(-area, area), 
                    randomRange(-area, area), 
                    randomRange(-1.5, 1.5), 
                    randomRange(-1.5, 1.5), 
                    randomRange(200, 400), 
                    '#ff4400'
                ),
                // Blue Planet (Light)
                new Body(
                    randomRange(-area, area), 
                    randomRange(-area, area), 
                    randomRange(-2, 2), 
                    randomRange(-2, 2), 
                    randomRange(50, 150), 
                    '#00ccff'
                )
            ];
        }

        function animate() {
            ctx.fillStyle = '#050505';
            ctx.fillRect(0, 0, width, height);

            for (let body of bodies) body.update(bodies);

            // KAMERA MANTIĞI
            let minX = Infinity, maxX = -Infinity, minY = Infinity, maxY = -Infinity;
            let centerX = 0, centerY = 0;

            for (let body of bodies) {
                centerX += body.x;
                centerY += body.y;
                minX = Math.min(minX, body.x);
                maxX = Math.max(maxX, body.x);
                minY = Math.min(minY, body.y);
                maxY = Math.max(maxY, body.y);
            }
            centerX /= bodies.length;
            centerY /= bodies.length;

            const rangeX = maxX - minX;
            const rangeY = maxY - minY;
            const range = Math.max(rangeX, rangeY, 400); 
            const targetScale = Math.min(width, height) / (range * 1.5); 
            
            if (!window.camera) window.camera = { x: 0, y: 0, scale: 1 };
            window.camera.x += (centerX - window.camera.x) * 0.05;
            window.camera.y += (centerY - window.camera.y) * 0.05;
            window.camera.scale += (targetScale - window.camera.scale) * 0.05;

            ctx.save();
            ctx.translate(width/2, height/2);
            ctx.scale(window.camera.scale, window.camera.scale);
            ctx.translate(-window.camera.x, -window.camera.y);

            for (let body of bodies) body.draw();

            ctx.restore();

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', init);
        init();
        animate();
    </script>
</body>
</html>