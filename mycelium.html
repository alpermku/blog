<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Mycelium - Alex Yalın</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/jpeg" href="assets/avatar.jpg">
    <style>
        body, html { margin: 0; padding: 0; overflow: hidden; background-color: #05080a; color: #eee; }
        canvas { display: block; }
        .overlay {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
            z-index: 10;
        }
        .overlay h1 {
            font-family: 'Inter', sans-serif;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.9);
            margin: 0;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 0 0 10px rgba(180,140,255,0.3);
        }
        .overlay p {
            font-family: 'Lora', serif;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
            margin: 5px 0 0 0;
        }
        .back-link {
            position: absolute;
            bottom: 20px;
            left: 20px;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.4);
            text-decoration: none;
            border-bottom: 1px solid transparent;
            transition: all 0.3s;
            pointer-events: auto;
        }
        .back-link:hover {
            color: #fff;
            border-bottom-color: #fff;
        }
        .hint {
            position: absolute;
            bottom: 20px;
            right: 20px;
            font-family: 'Inter', sans-serif;
            font-size: 0.7rem;
            color: rgba(255,255,255,0.25);
            pointer-events: none;
        }
    </style>
</head>
<body>
    <div class="overlay">
        <h1>The Mycelium</h1>
        <p>The hidden network. Intelligence without a brain.</p>
    </div>
    
    <a href="gallery.html" class="back-link">&larr; Back to Gallery</a>
    <div class="hint">click to seed · space to clear</div>

    <canvas id="c"></canvas>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');
        let W, H;
        
        // DLA-inspired mycelium growth
        let branches = [];
        let tips = [];
        let nutrients = [];
        let frame = 0;
        
        const BRANCH_LIMIT = 25000;
        const NUTRIENT_COUNT = 80;
        
        // Color palette: bioluminescent fungi
        const palette = [
            [140, 100, 255],  // violet
            [80, 180, 255],   // cyan
            [100, 255, 180],  // mint
            [200, 140, 255],  // lavender
            [60, 220, 220],   // teal
        ];
        
        class Tip {
            constructor(x, y, angle, depth, color, energy) {
                this.x = x;
                this.y = y;
                this.angle = angle;
                this.depth = depth;
                this.color = color || palette[Math.floor(Math.random() * palette.length)];
                this.energy = energy || 1.0;
                this.age = 0;
                this.speed = 1.2 + Math.random() * 0.8;
            }
            
            grow() {
                if (this.energy < 0.05 || branches.length > BRANCH_LIMIT) return false;
                
                // Seek nearest nutrient
                let pull = 0;
                for (let n of nutrients) {
                    const dx = n.x - this.x;
                    const dy = n.y - this.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    if (dist < 200 && dist > 5) {
                        pull = Math.atan2(dy, dx);
                        this.angle += (pull - this.angle) * 0.03;
                        if (dist < 15) {
                            n.x = Math.random() * W;
                            n.y = Math.random() * H;
                            this.energy = Math.min(this.energy + 0.3, 1.0);
                        }
                    }
                }
                
                // Organic wandering
                this.angle += (Math.random() - 0.5) * 0.4;
                
                const nx = this.x + Math.cos(this.angle) * this.speed;
                const ny = this.y + Math.sin(this.angle) * this.speed;
                
                // Draw branch segment
                const alpha = this.energy * 0.7;
                const width = Math.max(0.3, this.energy * 2.5 - this.depth * 0.15);
                const [r, g, b] = this.color;
                
                ctx.beginPath();
                ctx.moveTo(this.x, this.y);
                ctx.lineTo(nx, ny);
                ctx.strokeStyle = `rgba(${r},${g},${b},${alpha})`;
                ctx.lineWidth = width;
                ctx.stroke();
                
                // Glow
                if (this.energy > 0.4) {
                    ctx.beginPath();
                    ctx.arc(nx, ny, width * 2, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(${r},${g},${b},${alpha * 0.08})`;
                    ctx.fill();
                }
                
                branches.push({ x: nx, y: ny });
                this.x = nx;
                this.y = ny;
                this.energy -= 0.003;
                this.age++;
                
                // Branching
                if (this.age > 15 && Math.random() < 0.02 * this.energy && this.depth < 8) {
                    const fork = (Math.random() - 0.5) * 1.2;
                    tips.push(new Tip(
                        this.x, this.y,
                        this.angle + fork,
                        this.depth + 1,
                        this.color,
                        this.energy * 0.7
                    ));
                }
                
                // Bounds
                if (nx < -20 || nx > W + 20 || ny < -20 || ny > H + 20) return false;
                
                return true;
            }
        }
        
        function spawnNetwork(x, y) {
            const color = palette[Math.floor(Math.random() * palette.length)];
            const count = 3 + Math.floor(Math.random() * 4);
            for (let i = 0; i < count; i++) {
                const angle = (Math.PI * 2 / count) * i + (Math.random() - 0.5) * 0.5;
                tips.push(new Tip(x, y, angle, 0, color, 1.0));
            }
            
            // Spawn glow at origin
            ctx.beginPath();
            ctx.arc(x, y, 4, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(${color[0]},${color[1]},${color[2]},0.8)`;
            ctx.fill();
            ctx.beginPath();
            ctx.arc(x, y, 15, 0, Math.PI * 2);
            ctx.fillStyle = `rgba(${color[0]},${color[1]},${color[2]},0.1)`;
            ctx.fill();
        }
        
        function drawNutrients() {
            for (let n of nutrients) {
                const pulse = 0.3 + Math.sin(frame * 0.03 + n.phase) * 0.2;
                ctx.beginPath();
                ctx.arc(n.x, n.y, 2, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(255, 220, 100, ${pulse})`;
                ctx.fill();
            }
        }
        
        function init() {
            W = canvas.width = window.innerWidth;
            H = canvas.height = window.innerHeight;
            branches = [];
            tips = [];
            nutrients = [];
            frame = 0;
            
            ctx.fillStyle = '#05080a';
            ctx.fillRect(0, 0, W, H);
            
            // Scatter nutrients
            for (let i = 0; i < NUTRIENT_COUNT; i++) {
                nutrients.push({
                    x: Math.random() * W,
                    y: Math.random() * H,
                    phase: Math.random() * Math.PI * 2
                });
            }
            
            // Initial seeds
            spawnNetwork(W * 0.5, H * 0.5);
            spawnNetwork(W * 0.2, H * 0.7);
            spawnNetwork(W * 0.8, H * 0.3);
        }
        
        function animate() {
            // Subtle fade for trail effect
            ctx.fillStyle = 'rgba(5, 8, 10, 0.01)';
            ctx.fillRect(0, 0, W, H);
            
            drawNutrients();
            
            // Grow tips
            const growPerFrame = Math.min(tips.length, 20);
            let newTips = [];
            for (let i = tips.length - 1; i >= 0; i--) {
                if (tips[i].grow()) {
                    newTips.push(tips[i]);
                }
            }
            tips = newTips;
            
            // Occasionally spawn new nutrient pulses
            if (frame % 300 === 0 && nutrients.length < NUTRIENT_COUNT) {
                nutrients.push({
                    x: Math.random() * W,
                    y: Math.random() * H,
                    phase: Math.random() * Math.PI * 2
                });
            }
            
            frame++;
            requestAnimationFrame(animate);
        }
        
        // Interactions
        canvas.addEventListener('click', e => {
            spawnNetwork(e.clientX, e.clientY);
        });
        
        window.addEventListener('keydown', e => {
            if (e.code === 'Space') {
                e.preventDefault();
                init();
            }
        });
        
        window.addEventListener('resize', () => {
            W = canvas.width = window.innerWidth;
            H = canvas.height = window.innerHeight;
        });
        
        init();
        animate();
    </script>
</body>
</html>
